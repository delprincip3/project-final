<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - Ortoplan</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@days-ui/days-ui@0.0.5/dist/main.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-100">

    <!-- Header -->
    <header class="bg-green-700 text-white py-4 px-6 flex justify-between items-center">
        <h1 class="text-2xl font-bold">Benvenuto, Admin {{ utente.nome }} {{ utente.cognome }}</h1>
        <nav>
            <a href="{{ url_for('index') }}" class="text-white hover:underline">Home</a>
            <a href="{{ url_for('login') }}" class="text-white hover:underline">Logout</a>
        </nav>
    </header>

    <!-- Main content -->
    <div class="container mx-auto px-4 py-8">

        <!-- User List Section -->
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-xl font-semibold mb-4">Utenti</h2>
            <ul>
                {% for user in users %}
                    <li class="flex items-center justify-between py-2 border-b">
                        <span>{{ user.nome }} {{ user.cognome }} (ID: {{ user.id }})</span>
                        <div class="space-x-2">
                            <button onclick="editUser('{{ user.id }}')" class="btn btn-sm btn-blue">Modifica</button>
                            <button onclick="deleteUser('{{ user.id }}')" class="btn btn-sm btn-red">Elimina</button>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <!-- Piantagioni Section -->
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-xl font-semibold mb-4">Piantagioni</h2>
            <ul>
                {% for piantagione in piantagioni %}
                    <li class="flex items-center justify-between py-2 border-b">
                        <span>{{ piantagione.nome }} - {{ piantagione.descrizione }}</span>
                        <div class="space-x-2">
                            <button onclick="editPiantagione('{{ piantagione.id }}')" class="btn btn-sm btn-blue">Modifica</button>
                            <button onclick="deletePiantagione('{{ piantagione.id }}')" class="btn btn-sm btn-red">Elimina</button>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <!-- Trattamenti Section -->
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-xl font-semibold mb-4">Trattamenti</h2>
            <ul>
                {% for trattamento in trattamenti %}
                    <li class="flex items-center justify-between py-2 border-b">
                        <span>{{ trattamento.descrizione }} - {{ trattamento.data_inizio }} - {{ trattamento.data_fine }}</span>
                        <div class="space-x-2">
                            <button onclick="editTrattamento('{{ trattamento.id }}')" class="btn btn-sm btn-blue">Modifica</button>
                            <button onclick="deleteTrattamento('{{ trattamento.id }}')" class="btn btn-sm btn-red">Elimina</button>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>

     

    <!-- Footer -->
    <footer class="bg-green-600 text-white py-4 px-6 text-center">
        <p class="text-sm">Copyright Â© 2024 - All rights reserved by delprincip3</p>
    </footer>

    <script>
        // Funzioni per gestire modifiche ed eliminazioni
        function editUser(userId) {
            const nome = prompt("Inserisci il nuovo nome:");
            const cognome = prompt("Inserisci il nuovo cognome:");
            const email = prompt("Inserisci la nuova email:");
            const password = prompt("Inserisci la nuova password:")

            if (nome && cognome && email && password) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/dashboardadmin';

                const actionInput = document.createElement('input');
                actionInput.type = 'hidden';
                actionInput.name = 'action';
                actionInput.value = 'edit_user';
                form.appendChild(actionInput);

                const userIdInput = document.createElement('input');
                userIdInput.type = 'hidden';
                userIdInput.name = 'user_id';
                userIdInput.value = userId;
                form.appendChild(userIdInput);

                const nomeInput = document.createElement('input');
                nomeInput.type = 'hidden';
                nomeInput.name = 'nome';
                nomeInput.value = nome;
                form.appendChild(nomeInput);

                const cognomeInput = document.createElement('input');
                cognomeInput.type = 'hidden';
                cognomeInput.name = 'cognome';
                cognomeInput.value = cognome;
                form.appendChild(cognomeInput);

                const emailInput = document.createElement('input');
                emailInput.type = 'hidden';
                emailInput.name = 'email';
                emailInput.value = email;
                form.appendChild(emailInput);
                
                const passwordInput = document.createElement('input');
                passwordInput.type = 'hidden';
                passwordInput.name = 'password';
                passwordInput.value = password;
                form.appendChild(passwordInput);

                document.body.appendChild(form);
                form.submit();
            }
        }

        function deleteUser(userId) {
            if (confirm("Sei sicuro di voler eliminare questo utente?")) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/dashboardadmin';

                const actionInput = document.createElement('input');
                actionInput.type = 'hidden';
                actionInput.name = 'action';
                actionInput.value = 'delete_user';
                form.appendChild(actionInput);

                const userIdInput = document.createElement('input');
                userIdInput.type = 'hidden';
                userIdInput.name = 'user_id';
                userIdInput.value = userId;
                form.appendChild(userIdInput);

                document.body.appendChild(form);
                form.submit();
            }
        }

        function editPiantagione(piantagioneId) {
            const nome = prompt("Inserisci il nuovo nome:");
            const descrizione = prompt("Inserisci la nuova descrizione:");

            if (nome && descrizione) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/dashboardadmin';

                const actionInput = document.createElement('input');
                actionInput.type = 'hidden';
                actionInput.name = 'action';
                actionInput.value = 'edit_piantagione';
                form.appendChild(actionInput);

                const piantagioneIdInput = document.createElement('input');
                piantagioneIdInput.type = 'hidden';
                piantagioneIdInput.name = 'piantagione_id';
                piantagioneIdInput.value = piantagioneId;
                form.appendChild(piantagioneIdInput);

                const nomeInput = document.createElement('input');
                nomeInput.type = 'hidden';
                nomeInput.name = 'nome';
                nomeInput.value = nome;
                form.appendChild(nomeInput);

                const descrizioneInput = document.createElement('input');
                descrizioneInput.type = 'hidden';
                descrizioneInput.name = 'descrizione';
                descrizioneInput.value = descrizione;
                form.appendChild(descrizioneInput);

                document.body.appendChild(form);
                form.submit();
            }
        }

        function deletePiantagione(piantagioneId) {
            if (confirm("Sei sicuro di voler eliminare questa piantagione?")) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/dashboardadmin';

                const actionInput = document.createElement('input');
                actionInput.type = 'hidden';
                actionInput.name = 'action';
                actionInput.value = 'delete_piantagione';
                form.appendChild(actionInput);

                const piantagioneIdInput = document.createElement('input');
                piantagioneIdInput.type = 'hidden';
                piantagioneIdInput.name = 'piantagione_id';
                piantagioneIdInput.value = piantagioneId;
                form.appendChild(piantagioneIdInput);

                document.body.appendChild(form);
                form.submit();
            }
        }

        function editTrattamento(trattamentoId) {
            const descrizione = prompt("Inserisci la nuova descrizione:");
            const dataInizio = prompt("Inserisci la nuova data di inizio (YYYY-MM-DD):");
            const dataFine = prompt("Inserisci la nuova data di fine (YYYY-MM-DD):");

            if (descrizione && dataInizio && dataFine) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/dashboardadmin';

                const actionInput = document.createElement('input');
                actionInput.type = 'hidden';
                actionInput.name = 'action';
                actionInput.value = 'edit_trattamento';
                form.appendChild(actionInput);

                const trattamentoIdInput = document.createElement('input');
                trattamentoIdInput.type = 'hidden';
                trattamentoIdInput.name = 'trattamento_id';
                trattamentoIdInput.value = trattamentoId;
                form.appendChild(trattamentoIdInput);

                const descrizioneInput = document.createElement('input');
                descrizioneInput.type = 'hidden';
                descrizioneInput.name = 'descrizione';
                descrizioneInput.value = descrizione;
                form.appendChild(descrizioneInput);

                const dataInizioInput = document.createElement('input');
                dataInizioInput.type = 'hidden';
                dataInizioInput.name = 'data_inizio';
                dataInizioInput.value = dataInizio;
                form.appendChild(dataInizioInput);

                const dataFineInput = document.createElement('input');
                dataFineInput.type = 'hidden';
                dataFineInput.name = 'data_fine';
                dataFineInput.value = dataFine;
                form.appendChild(dataFineInput);

                document.body.appendChild(form);
                form.submit();
            }
        }

        function deleteTrattamento(trattamentoId) {
            if (confirm("Sei sicuro di voler eliminare questo trattamento?")) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/dashboardadmin';

                const actionInput = document.createElement('input');
                actionInput.type = 'hidden';
                actionInput.name = 'action';
                actionInput.value = 'delete_trattamento';
                form.appendChild(actionInput);

                const trattamentoIdInput = document.createElement('input');
                trattamentoIdInput.type = 'hidden';
                trattamentoIdInput.name = 'trattamento_id';
                trattamentoIdInput.value = trattamentoId;
                form.appendChild(trattamentoIdInput);

                document.body.appendChild(form);
                form.submit();
            }
        }
    </script>
</body>
</html>
